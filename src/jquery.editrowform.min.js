!function(t,n){"function"==typeof define&&define.amd?define(["jquery"],n):n(t.jQuery)}(this,function(t){"use strict";t.fn.editrowform=function(n){var e,o=Array.prototype.slice.call(arguments,1),i=this;return this.each(function(r,u){var a=t(u),d=a.data("editrowform");"string"==typeof n?d&&t.isFunction(d[n])&&(e=d[n].apply(d,o),r||(i=e)):d||(d=new t.editrowform(u,n))}),i},t.editrowform=function(n,e){function o(){if(P.$el.data("editrowform",P),P.options=t.extend({},t.editrowform.defaultOptions,e),S(),P.options.click){var n=t("tr td",P.el).parent();n.dblclick(function(t){i(this)}),n.click(function(t){r(this)})}P.options.hideOnBlur&&t(document).click(function(n){var e=t(n.target).closest(et).length,o=t(n.target).closest(P.el).length;e||o||U||y(),U=!1})}function i(n){v(t(n).index())}function r(n){dt.isHidden(et)||v(t(n).index())}function u(){return ot}function a(){var t=E().saveButtonTimeout;dt.isNotEmpty(t)&&dt.timeoutButton(at.getSaveButtonId(),t);for(var n,e=!0,o=[],i=0;i<N();i++)n=F(i),o.push(n);var r=E().onSave;dt.functionExists(r)&&(e=r(ot,ut,rt,o)),(e||dt.isEmpty(e))&&(f(ut,o),y())}function d(){var t=E().cancelButtonTimeout;dt.isNotEmpty(t)&&dt.timeoutButton(at.getCancelButtonId(),t);var n=!0,e=E().onCancel;dt.functionExists(e)&&(n=e(ot,ut,rt)),(n||dt.isEmpty(n))&&y()}function c(t){dt.isEmpty(t)&&(t=!0);var n=!0,e=T(),o=0!==e&&t?s():l(),u=E().onAddRow;return dt.functionExists(u)&&(n=u(e,o)),!n&&!dt.isEmpty(n)||dt.isEmpty(o)?!1:(E().click&&(o.dblclick(function(t){i(this)}),o.click(function(t){r(this)})),o.appendTo(P.$el),e)}function s(){var n=(T(),w(T()-1)),e=t(n).clone();return e.prop("id",""),t("td",e).each(function(n,e){var o=nt[n];o.ignore||t(this).html("&nbsp;")}),e}function l(){for(var n,e=N(),o=t(st.tr),i=0;e>i;i++)n=t(st.td),n.appendTo(o),n.html("&nbsp;");return o}function p(t){if(B(t)){var n=!0,e=w(t),o=E().onDeleteRow;dt.functionExists(o)&&(n=o(t,e)),!n&&!dt.isEmpty(n)||dt.isEmptyArray(e)||e.remove()}}function f(t,n){if(B(t))for(var e=0;e<N();e++)z(e)||G(e)||k(t,e,n[e])}function m(t){U=!0,v(t)}function v(t){if(B(t)&&null!==et){M(t);var n=w(t);j(n),R(t),et.show(),q(),E().focusOnInput&&h(),rt=n,ut=t}}function h(){t("input",et).each(function(n,e){var o=t(e).prop("disabled");return o?void 0:(t(e).focus(),!1)})}function y(){if(null!==et&&!dt.isHidden(et)){et.hide();var t=E().onHide;dt.functionExists(t)&&t(ot,ut,rt)}}function g(){P.$el.removeData("editrowform"),et&&(et.remove(),et=null)}function E(){return P.options}function x(){var n=t("thead tr",P.el);return dt.isNotEmpty(n)?n:t("th",P.el).parent()}function I(n){var e,o=x();return dt.isNotEmpty(o)&&(e=t("th",o)[n]),e}function w(n){return t("tbody tr",P.el).eq(n)}function C(n,e){var o,i=w(n);return dt.isNotEmpty(i)&&(o=t("td",i)[e]),o}function b(n,e){var o,i=C(n,e),r=L(e),u=t("input",i);o=dt.isEmptyArray(u)?t(i).text().trim():ct.getValue(u,r);var a=E().getCellValue;return dt.functionExists(a)&&(o=a(n,e,o,w(n),i)),o}function k(n,e,o){var i,r=L(e),u=C(n,e),a=E().setCellValue;dt.functionExists(a)?a(n,e,o,w(n),u):(i=t("input",u),dt.isEmptyArray(i)?t(u).text(o):ct.setValue(i,r,o))}function N(){var n=x();return dt.isEmptyArray(n)?t("td",w(0)).length:t("th",n).length}function T(){return t("tbody tr",P.el).length}function B(t){return dt.isEmpty(t)?!1:isNaN(t)?!1:0>t||t>=T()?!1:!0}function R(t){for(var n=0;n<N();n++)V(t,n,b(t,n))}function V(n,e,o){var i,r,u=at.getInputId(e),a=(w(n),E().setInputValue);dt.functionExists(a)?a(n,e,o,u,ot,w(n),C(n,e),I(e)):(i=L(e),r=t("."+Z+e,ot),ct.setValue(r,i,o))}function F(n){var e,o=t("."+Z+n,ot);dt.isEmptyArray(o)||(e=ct.getValue(o,L(n)));var i=E().getInputValue;return dt.functionExists(i)&&(e=i(ut,n,e,at.getInputId(n),ot,rt,C(ut,n),I(n))),e}function A(n){if(!G(n)){var e=at.getInputId(n),o=at.getInputName(n),i=ct.createInput(e,o,L(n));z(n)&&i.prop("disabled",!0);var r=E().renderInput;return dt.functionExists(r)&&(i=r(i,ut,n,I(n))),i&&t(i).addClass(Z+n),i}}function S(){W(),O()}function W(){var n,e,o=P.options.columns,i=0,r={};for(i=0;i<N();i++)r[i]=dt.clone(P.options.defaultColumn);if(dt.isNotEmpty(o)&&t.isArray(o))for(i=0;i<o.length;i++)n=o[i],dt.isNotEmpty(n)&&(e=n.colIndex,dt.isEmpty(e)&&(e=i),r[e]=n);nt=r}function O(){var n=t(st.div);n.prop("id",at.getEditRowFormId()),n.addClass(Y),n.addClass(E().cssClass),n.hide(),n.appendTo(document.body);var e=t(st.form);e.prop("id",at.getFormId()),e.prop("tabindex",0),e.addClass("form"),e.appendTo(n);var o=H();o.appendTo(e);var i=D();i.appendTo(n),it=i,et=n,ot=e}function H(){var n=t(st.div);n.prop("id",at.getFormRowId()),n.addClass("row");for(var e=null,o=0;o<N();o++)e=$(o),e.appendTo(n);return n}function $(n){var e=t(st.div);e.prop("id",at.getFormCellId(n)),e.addClass("cell"),e.addClass(_+n);var o=A(n);return o&&o.appendTo(e),e}function D(){var n=t(st.div),e=t(st.button);e.prop("id",at.getSaveButtonId()),e.addClass("save"),e.appendTo(n),e.text(E().saveText),e.on("click",a);var o=t(st.button);o.prop("id",at.getCancelButtonId()),o.addClass("cancel"),o.appendTo(n),o.text(E().cancelText),o.on("click",d);var i=t(st.div);return i.addClass("save-and-cancel-bar"),i.addClass("button-bar"),n.appendTo(i),i}function j(n){var e=t(n).offset();dt.position(et,e.top,e.left)}function q(){var n=t(it).innerWidth(),e=P.$el.innerWidth(),o=(e-n)/2;it.css({left:o,position:"absolute"})}function L(n){var e=nt[n].type;return"datepicker"!==e||t.datepicker?dt.isNotEmpty(e)?e:Q(n):tt}function Q(n){var e=C(0,n),o=t("input, select, textarea",e).prop("type");return dt.isNotEmpty(o)&&-1!=o.indexOf("select")?"select":dt.isNotEmpty(o)?o:tt}function z(t){var n=nt[t].disabled;return dt.isNotEmpty(n)?dt.toBoolean(n):!1}function G(t){var n=nt[t].ignore;return dt.isNotEmpty(n)?dt.toBoolean(n):!1}function J(n){var e=I(n);if(dt.isNotEmpty(e)){{t(e).innerWidth(),t(e).innerWidth()}return t(e).innerWidth()}var o=C(ut,n);return dt.isNotEmpty(o)?t(o).innerWidth():0}function K(n){var e=w(n);return dt.isNotEmpty(e)?t(e).outerHeight():0}function M(n){et.width(dt.getWidth(P.el)),t(".row .cell",et).height(K(n));for(var e=0;e<N();e++){var o=t("."+_+e,et),i=J(e);o.width(i);var r=L(e);"checkbox"!==r&&t("."+Z+e,o).width(i-X)}}var P=this;P.$el=t(n),P.el=n,P.save=a,P.addRow=c,P.deleteRow=p,P.setRowValues=f,P.show=m,P.hide=y,P.destroy=g,P.getRowCount=T,P.getColumnCount=N,P.getForm=u;var U,X=4,Y="erf",Z="input-",_="cell-",tt="text",nt={},et=null,ot=null,it=null,rt=null,ut=null,at={idSuffix:"-erf",getEditRowFormId:function(t){var n=P.options.id;return dt.isEmpty(n)&&(n=P.el.id),dt.isEmpty(n)&&(n="no-id-"+(new Date).getTime()),n+this.idSuffix},getInputId:function(t){var n=nt[t].id;return dt.isNotEmpty(n)?n:this.getEditRowFormId()+"-input"+t},getInputName:function(n){var e=nt[n].name;if(dt.isNotEmpty(e))return e;var o=I(n);return e=t(o).text().trim(),dt.isNotEmpty(e)?e:this.getEditRowFormId()+"-input"+n},getFormCellId:function(t){return this.getEditRowFormId()+"-cell-"+t},getFormRowId:function(){return this.getEditRowFormId()+"-row"},getFormId:function(){return this.getEditRowFormId()+"-form"},getSaveButtonId:function(){return this.getEditRowFormId()+"-save"},getCancelButtonId:function(){return this.getEditRowFormId()+"-cancel"}},dt={timeoutButton:function(n,e){e||(e=1e3);var o="#"+n;t(o).prop("disabled",!0),setTimeout(function(){t(o).prop("disabled",!1)},e)},functionExists:function(n){return"undefined"!=typeof n&&t.isFunction(n)},isEmptyArray:function(t){return this.isEmpty(t)?!0:"undefined"!=typeof t.length?0===t.length:!0},isEmpty:function(n){return void 0===n||null===n||"undefined"==typeof n||"null"==t.trim(n)||""===t.trim(n)},isNotEmpty:function(t){return!this.isEmpty(t)},getWidth:function(n){return t(n).width()},clone:function(n){return t.extend(!0,{},n)},isHidden:function(n){return"none"==t(n).css("display")},position:function(n,e,o){t(n).css({top:e,left:o,position:"absolute"})},toBoolean:function(t){return this.isEmpty(t)?!1:t===!0||t===!1?t:(t=t.toLowerCase(),"y"==t||"true"==t||"yes"==t||"1"==t?!0:!1)}},ct={createInput:function(n,e,o){var i;return"checkbox"==o?(i=t(st.checkbox),i.prop("id",n),i.prop("name",e)):"datepicker"==o?(i=t(st.textfield),i.prop("id",n),i.prop("name",e),t(i).datepicker()):(i=t(st.textfield),i.prop("id",n),i.prop("name",e)),i},getValue:function(n,e){return"checkbox"==e?this.getCheckboxValue(n):t(n).val()},setValue:function(n,e,o){"checkbox"==e?this.setCheckboxValue(n,o):t(n).val(o)},getCheckboxValue:function(n){return t(n).prop("checked")},setCheckboxValue:function(n,e){t(n).prop("checked",dt.toBoolean(e))}},st={td:"<td />",tr:"<tr />",div:"<div />",form:"<form />",button:"<button />",textfield:"<input type='text' />",checkbox:"<input type='checkbox' />"};o()},t.editrowform.defaultOptions={id:"",cssClass:"",click:!0,saveText:"Save",cancelText:"Cancel",saveButtonTimeout:"",cancelButtonTimeout:"",hideOnBlur:!0,focusOnInput:!1,columns:"",defaultColumn:{colIndex:"",id:"",name:"",type:"",disabled:"",ignore:""},onSave:"",onCancel:"",onHide:"",onDeleteRow:"",onAddRow:"",getCellValue:"",setCellValue:"",getInputValue:"",setInputValue:"",renderInput:""}});